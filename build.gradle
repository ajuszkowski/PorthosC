apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'antlr'
//apply plugin: 'idea'

repositories {
    flatDir {
        dirs 'lib'
    }
    jcenter()
    //mavenCentral()
}

dependencies {
    testCompile 'junit:junit:4.12'
    antlr "org.antlr:antlr4:4.7"

    // command-line options https://mvnrepository.com/artifact/com.beust/jcommander
    compile "com.beust:jcommander:1.71"

    compile "commons-io:commons-io:2.5"

    // local dependencies:
    compile name: "com.microsoft.z3"
}

ext.antlr = [
    generatedSourceDir: "src/generated/java/",
    grammarsDir: "src/main/antlr/",
    resultPackage: "mousquetaires.languages.parsers",
]


generateGrammarSource {
    arguments = (["-visitor", "-listener", "-package", antlr.resultPackage] + arguments)
    outputDirectory = file("${project.projectDir}/${antlr.generatedSourceDir}/${antlr.resultPackage.replaceAll("\\.", "/")}")
}

compileJava {
    dependsOn generateGrammarSource
    source "${project.projectDir}/${antlr.generatedSourceDir}"
}

clean {
    delete += fileTree(antlr.generatedSourceDir).include('**/*')
}

task getHomeDir {
    println gradle.gradleHomeDir
}

mainClassName = 'mousquetaires.Program'


